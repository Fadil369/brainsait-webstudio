# Cloudflare Workers Configuration for BrainSAIT
# Migrated from Pages to Workers for full-stack capabilities
# https://developers.cloudflare.com/workers/static-assets/

name = "brainsait-webstudio"
main = "build/server/index.js"
compatibility_date = "2024-11-21"
compatibility_flags = ["nodejs_compat"]

# Workers.dev subdomain (optional)
workers_dev = true

# Enable preview URLs for non-production builds
preview_urls = true

# Smart Placement for optimal performance
[placement]
mode = "smart"

# Static Assets Configuration
[assets]
directory = "build/client"
binding = "ASSETS"
# SPA mode for React Router
not_found_handling = "single-page-application"

# Production Environment Variables
# Set secrets via: wrangler secret put STRIPE_SECRET_KEY
[vars]
NODE_ENV = "production"

# Preview Environment
[env.preview]
compatibility_date = "2024-11-21"

[env.preview.vars]
NODE_ENV = "development"
STRIPE_PUBLIC_KEY = "pk_test_51QNEwlF4XY8Zkb2J9CORlTdLn5N4QAMaUe39pC6z0UGMqN0PCh0gxzS5dWJEuAWxcQfMJJCiF3wZXwk7SBt7k9zx00VEQ8tZQi"

# Optional: Add bindings as needed
# [[kv_namespaces]]
# binding = "BRAINSAIT_KV"
# id = "your-kv-namespace-id"

# [[d1_databases]]
# binding = "DB"
# database_name = "brainsait-db"
# database_id = "your-database-id"

# [[r2_buckets]]
# binding = "ASSETS_BUCKET"
# bucket_name = "brainsait-assets"
